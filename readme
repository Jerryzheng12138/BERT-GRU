## BERT GRU-----A AMP Prediction Tool
Two-stage BERT-GRU model for antimicrobial peptide identification and functional prediction.
## Requirements
Python 3.8 with these packages
 Name                    Version                   Build  Channel
_tflow_select             2.3.0                     eigen    defaults
abseil-cpp                20230802.0           h5da7b33_2    defaults
absl-py                   2.1.0                    pypi_0    pypi
aiohttp                   3.9.0            py38h2bbff1b_0    defaults
aiosignal                 1.2.0              pyhd3eb1b0_0    defaults
astor                     0.8.1            py38haa95532_0    defaults
astunparse                1.6.3                      py_0    defaults
async-timeout             4.0.3            py38haa95532_0    defaults
attrs                     23.1.0           py38haa95532_0    defaults
biopython                 1.78             py38h2bbff1b_0    defaults
blas                      1.0                         mkl    defaults
blinker                   1.6.2            py38haa95532_0    defaults
blosum                    2.0.3                    pypi_0    pypi
boto3                     1.34.133                 pypi_0    pypi
botocore                  1.34.133                 pypi_0    pypi
bottleneck                1.3.5            py38h080aedc_0    defaults
brotli-python             1.0.9            py38hd77b12b_7    defaults
c-ares                    1.19.1               h2bbff1b_0    defaults
ca-certificates           2023.12.12           haa95532_0    defaults
cachetools                4.2.2              pyhd3eb1b0_0    defaults
certifi                   2023.11.17       py38haa95532_0    defaults
cffi                      1.16.0           py38h2bbff1b_0    defaults
charset-normalizer        2.0.4              pyhd3eb1b0_0    defaults
click                     8.1.7            py38haa95532_0    defaults
colorama                  0.4.6            py38haa95532_0    defaults
contourpy                 1.1.1                    pypi_0    pypi
cpuonly                   2.0                           0    pytorch
cryptography              41.0.7           py38h89fc84f_0    defaults
cycler                    0.12.1                   pypi_0    pypi
datasets                  2.20.0                   pypi_0    pypi
dill                      0.3.8                    pypi_0    pypi
filelock                  3.13.1           py38haa95532_0    defaults
flask                     3.0.3                    pypi_0    pypi
flatbuffers               24.3.25                  pypi_0    pypi
fonttools                 4.51.0                   pypi_0    pypi
freetype                  2.12.1               ha860e81_0    defaults
frozenlist                1.4.0            py38h2bbff1b_0    defaults
fsspec                    2024.5.0                 pypi_0    pypi
gast                      0.3.3                    pypi_0    pypi
giflib                    5.2.1                h8cc25b3_3    defaults
gmpy2                     2.1.2            py38h7f96b67_0    defaults
google-auth               2.22.0           py38haa95532_0    defaults
google-auth-oauthlib      0.4.6                    pypi_0    pypi
google-pasta              0.2.0              pyhd3eb1b0_0    defaults
grpc-cpp                  1.48.2               h6772dbd_4    defaults
grpcio                    1.64.0                   pypi_0    pypi
gtest                     1.14.0               h59b6b97_0    defaults
h5py                      3.11.0                   pypi_0    pypi
hdf5                      1.10.4               h7ebc959_0    defaults
huggingface-hub           0.23.4                   pypi_0    pypi
icc_rt                    2022.1.0             h6049295_2    defaults
idna                      3.4              py38haa95532_0    defaults
imbalanced-learn          0.12.3                   pypi_0    pypi
importlib-metadata        6.0.0            py38haa95532_0    defaults
importlib-resources       6.4.0                    pypi_0    pypi
intel-openmp              2023.1.0         h59b6b97_46320    defaults
itsdangerous              2.2.0                    pypi_0    pypi
jinja2                    3.1.2            py38haa95532_0    defaults
jmespath                  1.0.1                    pypi_0    pypi
joblib                    1.2.0            py38haa95532_0    defaults
jpeg                      9e                   h2bbff1b_1    defaults
keras                     2.8.0                    pypi_0    pypi
keras-applications        1.0.8                      py_1    defaults
keras-preprocessing       1.1.2              pyhd3eb1b0_0    defaults
kiwisolver                1.4.5                    pypi_0    pypi
lerc                      3.0                  hd77b12b_0    defaults
libclang                  18.1.1                   pypi_0    pypi
libdeflate                1.17                 h2bbff1b_1    defaults
libffi                    3.4.4                hd77b12b_0    defaults
libjpeg-turbo             2.0.0                h196d8e1_0    defaults
libpng                    1.6.39               h8cc25b3_0    defaults
libprotobuf               3.20.3               h23ce68f_0    defaults
libtiff                   4.5.1                hd77b12b_0    defaults
libuv                     1.44.2               h2bbff1b_0    defaults
libwebp                   1.3.2                hbc33d0d_0    defaults
libwebp-base              1.3.2                h2bbff1b_0    defaults
lmdb                      1.4.1                    pypi_0    pypi
lz4-c                     1.9.4                h2bbff1b_0    defaults
markdown                  3.4.1            py38haa95532_0    defaults
markupsafe                2.1.1            py38h2bbff1b_0    defaults
matplotlib                3.7.5                    pypi_0    pypi
mkl                       2023.1.0         h6b88ed4_46358    defaults
mkl-service               2.4.0            py38h2bbff1b_1    defaults
mkl_fft                   1.3.8            py38h2bbff1b_0    defaults
mkl_random                1.2.4            py38h59b6b97_0    defaults
mlxtend                   0.23.1                   pypi_0    pypi
mpc                       1.1.0                h7edee0f_1    defaults
mpfr                      4.0.2                h62dcd97_1    defaults
mpir                      3.0.0                hec2e145_1    defaults
mpmath                    1.3.0            py38haa95532_0    defaults
multidict                 6.0.4            py38h2bbff1b_0    defaults
multiprocess              0.70.16                  pypi_0    pypi
networkx                  3.1              py38haa95532_0    defaults
numexpr                   2.8.4            py38h7b80656_1    defaults
numpy                     1.24.2                   pypi_0    pypi
oauthlib                  3.2.2            py38haa95532_0    defaults
opencv-python             4.9.0.80                 pypi_0    pypi
openjpeg                  2.4.0                h4fc8c34_0    defaults
openssl                   3.0.12               h2bbff1b_0    defaults
opt_einsum                3.3.0              pyhd3eb1b0_1    defaults
packaging                 23.1             py38haa95532_0    defaults
pandas                    1.1.5                    pypi_0    pypi
pillow                    9.3.0                    pypi_0    pypi
pip                       23.3.1           py38haa95532_0    defaults
platformdirs              3.10.0           py38haa95532_0    defaults
pooch                     1.7.0            py38haa95532_0    defaults
propy                     1.0.0                    pypi_0    pypi
propy3                    1.1.1                    pypi_0    pypi
protlearn                 0.0.3                    pypi_0    pypi
protobuf                  3.19.4                   pypi_0    pypi
pyarrow                   16.1.0                   pypi_0    pypi
pyarrow-hotfix            0.6                      pypi_0    pypi
pyasn1                    0.4.8              pyhd3eb1b0_0    defaults
pyasn1-modules            0.2.8                      py_0    defaults
pycparser                 2.21               pyhd3eb1b0_0    defaults
pyjwt                     2.4.0            py38haa95532_0    defaults
pyopenssl                 23.2.0           py38haa95532_0    defaults
pyparsing                 3.1.2                    pypi_0    pypi
pyreadline                2.1                      py38_1    defaults
pyside2                   5.15.2.1                 pypi_0    pypi
pysocks                   1.7.1            py38haa95532_0    defaults
python                    3.8.18               h1aa4202_0    defaults
python-dateutil           2.8.2              pyhd3eb1b0_0    defaults
python-tzdata             2023.3             pyhd3eb1b0_0    defaults
pytorch-mutex             1.0                         cpu    pytorch
pytz                      2023.3.post1     py38haa95532_0    defaults
pyyaml                    6.0.1            py38h2bbff1b_0    defaults
qt-material               2.14                     pypi_0    pypi
re2                       2022.04.01           hd77b12b_0    defaults
regex                     2024.5.15                pypi_0    pypi
requests                  2.32.3                   pypi_0    pypi
requests-oauthlib         1.3.0                      py_0    defaults
rsa                       4.7.2              pyhd3eb1b0_1    defaults
s3transfer                0.10.2                   pypi_0    pypi
safetensors               0.4.3                    pypi_0    pypi
scikit-learn              1.3.2                    pypi_0    pypi
scikit-multilearn         0.2.0                    pypi_0    pypi
scipy                     1.5.4                    pypi_0    pypi
setuptools                68.2.2           py38haa95532_0    defaults
shiboken2                 5.15.2.1                 pypi_0    pypi
six                       1.15.0                   pypi_0    pypi
sqlite                    3.41.2               h2bbff1b_0    defaults
sympy                     1.12             py38haa95532_0    defaults
tape-proteins             0.5                      pypi_0    pypi
tbb                       2021.8.0             h59b6b97_0    defaults
tensorboard               2.8.0                    pypi_0    pypi
tensorboard-data-server   0.6.1                    pypi_0    pypi
tensorboard-plugin-wit    1.8.1            py38haa95532_0    defaults
tensorboardx              2.6.2.2                  pypi_0    pypi
tensorflow                2.8.0                    pypi_0    pypi
tensorflow-estimator      2.13.0                   pypi_0    pypi
tensorflow-intel          2.13.0                   pypi_0    pypi
tensorflow-io-gcs-filesystem 0.31.0                   pypi_0    pypi
termcolor                 1.1.0                    pypi_0    pypi
tf-estimator-nightly      2.8.0.dev2021122109          pypi_0    pypi
tensorboardx              2.6.2.2                  pypi_0    pypi
tensorflow                2.8.0                    pypi_0    pypi
tensorflow-estimator      2.13.0                   pypi_0    pypi
tensorflow-intel          2.13.0                   pypi_0    pypi
tensorflow-io-gcs-filesystem 0.31.0                   pypi_0    pypi
termcolor                 1.1.0                    pypi_0    pypi
tf-estimator-nightly      2.8.0.dev2021122109          pypi_0    pypi
tensorflow                2.8.0                    pypi_0    pypi
tensorflow-estimator      2.13.0                   pypi_0    pypi
tensorflow-intel          2.13.0                   pypi_0    pypi
tensorflow-io-gcs-filesystem 0.31.0                   pypi_0    pypi
termcolor                 1.1.0                    pypi_0    pypi
tf-estimator-nightly      2.8.0.dev2021122109          pypi_0    pypi
tensorflow-estimator      2.13.0                   pypi_0    pypi
tensorflow-intel          2.13.0                   pypi_0    pypi
tensorflow-io-gcs-filesystem 0.31.0                   pypi_0    pypi
termcolor                 1.1.0                    pypi_0    pypi
tf-estimator-nightly      2.8.0.dev2021122109          pypi_0    pypi
tensorflow-intel          2.13.0                   pypi_0    pypi
tensorflow-io-gcs-filesystem 0.31.0                   pypi_0    pypi
termcolor                 1.1.0                    pypi_0    pypi
tf-estimator-nightly      2.8.0.dev2021122109          pypi_0    pypi
threadpoolctl             2.2.0              pyh0d69192_0    defaults
tk                        8.6.12               h2bbff1b_0    defaults
tensorflow-io-gcs-filesystem 0.31.0                   pypi_0    pypi
termcolor                 1.1.0                    pypi_0    pypi
tf-estimator-nightly      2.8.0.dev2021122109          pypi_0    pypi
threadpoolctl             2.2.0              pyh0d69192_0    defaults
tk                        8.6.12               h2bbff1b_0    defaults
tokenizers                0.19.1                   pypi_0    pypi
termcolor                 1.1.0                    pypi_0    pypi
tf-estimator-nightly      2.8.0.dev2021122109          pypi_0    pypi
threadpoolctl             2.2.0              pyh0d69192_0    defaults
tk                        8.6.12               h2bbff1b_0    defaults
tokenizers                0.19.1                   pypi_0    pypi
torch                     2.1.2+cu121              pypi_0    pypi
threadpoolctl             2.2.0              pyh0d69192_0    defaults
tk                        8.6.12               h2bbff1b_0    defaults
tokenizers                0.19.1                   pypi_0    pypi
torch                     2.1.2+cu121              pypi_0    pypi
tokenizers                0.19.1                   pypi_0    pypi
torch                     2.1.2+cu121              pypi_0    pypi
torchaudio                2.1.2                  py38_cpu    pytorch
torchvision               0.16.2                 py38_cpu    pytorch
torch                     2.1.2+cu121              pypi_0    pypi
torchaudio                2.1.2                  py38_cpu    pytorch
torchvision               0.16.2                 py38_cpu    pytorch
torchaudio                2.1.2                  py38_cpu    pytorch
torchvision               0.16.2                 py38_cpu    pytorch
tqdm                      4.66.4                   pypi_0    pypi
transformers              4.41.2                   pypi_0    pypi
typing-extensions         4.3.0                    pypi_0    pypi
torchvision               0.16.2                 py38_cpu    pytorch
tqdm                      4.66.4                   pypi_0    pypi
transformers              4.41.2                   pypi_0    pypi
typing-extensions         4.3.0                    pypi_0    pypi
urllib3                   1.26.18          py38haa95532_0    defaults
tqdm                      4.66.4                   pypi_0    pypi
transformers              4.41.2                   pypi_0    pypi
typing-extensions         4.3.0                    pypi_0    pypi
urllib3                   1.26.18          py38haa95532_0    defaults
typing-extensions         4.3.0                    pypi_0    pypi
urllib3                   1.26.18          py38haa95532_0    defaults
vc                        14.2                 h21ff451_1    defaults
vs2015_runtime            14.27.29016          h5e58377_2    defaults
urllib3                   1.26.18          py38haa95532_0    defaults
vc                        14.2                 h21ff451_1    defaults
vs2015_runtime            14.27.29016          h5e58377_2    defaults
vc                        14.2                 h21ff451_1    defaults
vs2015_runtime            14.27.29016          h5e58377_2    defaults
vs2015_runtime            14.27.29016          h5e58377_2    defaults
werkzeug                  3.0.3                    pypi_0    pypi
werkzeug                  3.0.3                    pypi_0    pypi
wheel                     0.41.2           py38haa95532_0    defaults
win_inet_pton             1.1.0            py38haa95532_0    defaults
wrapt                     1.12.1                   pypi_0    pypi
xgboost                   2.1.0                    pypi_0    pypi
xxhash                    3.4.1                    pypi_0    pypi
xz                        5.4.5                h8cc25b3_0    defaults
yaml                      0.2.5                he774522_0    defaults
yarl                      1.9.3            py38h2bbff1b_0    defaults
zipp                      3.11.0           py38haa95532_0    defaults
zlib                      1.2.13               h8cc25b3_0    defaults
zstd                      1.5.5                hd43e919_0    defaults

## AMP identification:
python stage1.py

## AMP functional classification:
python stage2.py
(ps.The default is antigram-negative. If you need other types, you need to modify the relevant file names of stage2.py.)

## Web interface:
python app.py

## Model weights
https://drive.google.com/drive/folders/1P5h5J63I3JF4D1_BVgiA6HsOVB5RFfZd?usp=drive_link
(ps.Placed in the specified directory: ./data/saved_dict)